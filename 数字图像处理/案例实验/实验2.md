![image-20201003184409313](../../../AppData/Roaming/Typora/typora-user-images/image-20201003184409313.png)

![image-20201003184447469](../../../AppData/Roaming/Typora/typora-user-images/image-20201003184447469.png)

![image-20201003184636455](../../../AppData/Roaming/Typora/typora-user-images/image-20201003184636455.png)

![image-20201003184835535](../../../AppData/Roaming/Typora/typora-user-images/image-20201003184835535.png)

错误总结

错误1 函数找不到 原因 opencv 没导入

![image-20201003223530440](https://raw.githubusercontent.com/kujin521/Typora_images/master/img/20201003223530.png)

在头部添加

```c
#include<openCV2/core/core.hpp>
#include<openCV2/highgui/highgui.hpp>
#include<opencv2/highgui/highgui_c.h>
#include <opencv2/imgproc/imgproc.hpp>
```

错误2 无法从LPCTSTR 转换成 string 原因 字符集错误

> 严重性	代码	说明	项目	文件	行	禁止显示状态
> 错误	C2440	“初始化”: 无法从“LPCTSTR”转换为“std::basic_string<char,std::char_traits<char>,std::allocator<char>>”	Demo2	D:\Documents\Visual Studio 2019\opencv_apps\OpenCV_Test\Demo2\Demo2Dlg.cpp	207	

项目	属性	配置属性	高级(常规)	字符集	选择使用多字节字符集

![image-20201003223938301](https://raw.githubusercontent.com/kujin521/Typora_images/master/img/20201003223938.png)

创建一个mfc 对于dialog 的项目

界面

![img](https://raw.githubusercontent.com/kujin521/Typora_images/master/img/20201004103005.jpg) 

核心代码

```c++
void CDemo2Dlg::OnBnClickedButton1()
{
	// 点击open 打开图片事件

	//CFileDialog类封装了Windows常用的文件对话框，提供了文件打开和文件存盘对话框功能。可以用其构造函数创建打开图片或视频的对话框；
	CFileDialog dlg(TRUE, _T("*.jpg"), NULL, OFN_FILEMUSTEXIST | OFN_PATHMUSTEXIST, _T("Image files(*.bmp,*.jpg)|*.bmp;*.jpg|All files(*.*)|*.*|"), NULL);


	dlg.m_ofn.lpstrTitle = _T("Open Images");

	if (dlg.DoModal() != IDOK) {
		return;
	}

	//获取路径
	CString filePath = dlg.GetPathName();

	//将路径转换字符类型
	string sFileName=(LPCTSTR) filePath;

	//Imread（）函数用来图像的读取
	src = imread(sFileName);

	//如果 内容为空
	if (src.empty())
	{
		AfxMessageBox(_T("图像读取错误! "));
		return;
	}
	else {
		CRect rect;
		//图片控件绑定
		GetDlgItem(IDC_PIC)->GetClientRect(&rect);
		Mat img;

		//图片缩放 到正常大小
		resize(src, img, Size(rect.Width(), rect.Height()));

		//显示图片
		imshow("view", img);
	}
}


void CDemo2Dlg::OnBnClickedVidio()
{
	// 打开视频事件

	/*CFileDialog dlg(TRUE, _T("*.avi"), NULL, OFN_FILEMUSTEXIST | OFN_PATHMUSTEXIST, _T("Vidio files(*.avi)|*.avi|All files(*.*)|*.*|"), NULL);


	dlg.m_ofn.lpstrTitle = _T("Open Vido");

	if (dlg.DoModal() != IDOK) {
		return;
	}

	CString filePath = dlg.GetPathName();

	string sFileName = (LPCTSTR)filePath;*/

	VideoCapture capture;

	//int re=capture.open(sFileName);

	//打开摄像头
	//int re = capture.open(0);

	//打开网络源 cctv5
	int re = capture.open("http://ivi.bupt.edu.cn/hls/hunanhd.m3u8");

	if (!re) {
		AfxMessageBox("Can not open Video!");
		return;
	}

	CRect rect;

	GetDlgItem(IDC_PIC)->GetClientRect(&rect);

	Mat img;
	Mat frame;

	while(1) {

		capture >> frame;

		if (frame.empty())
		{
			//AfxMessageBox(_T("视频读取错误! "));
			return;
		}
		else {
			resize(frame, img, Size(rect.Width(), rect.Height()));

			imshow("view", img);

			waitKey(30);
		}

		
	}
```

 

一、总结

在学习过程中遇到了很多错误, 在此做一个总结

错误1 类,函数认识不清 导致代码写错 不知道出现位置

错误2 opencv 提示 没有该函数 解决 导入相关的include

\#include<openCV2/core/core.hpp>

\#include<openCV2/highgui/highgui.hpp>

\#include<opencv2/highgui/highgui_c.h>

\#include <opencv2/imgproc/imgproc.hpp>

出现这个原因 可能是 opencv 没有配置好